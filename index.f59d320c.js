var e,t,n,r,o,i,l,a,c,u,s,f,d,p,m,y,v="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},h={},g={},b=function(e){return e&&e.Math===Math&&e};g=b("object"==typeof globalThis&&globalThis)||b("object"==typeof window&&window)||b("object"==typeof self&&self)||b("object"==typeof v&&v)||b("object"==typeof g&&g)||function(){return this}()||Function("return this")();var w={},E={};w=!(E=function(e){try{return!!e()}catch(e){return!0}})(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]});var T={},S={};S=!E(function(){var e=(function(){}).bind();return"function"!=typeof e||e.hasOwnProperty("prototype")});var k=Function.prototype.call;T=S?k.bind(k):function(){return k.apply(k,arguments)};var C={}.propertyIsEnumerable,O=Object.getOwnPropertyDescriptor;r=O&&!C.call({1:2},1)?function(e){var t=O(this,e);return!!t&&t.enumerable}:C;var M={};M=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}};var L={},j={},B={},F=Function.prototype,I=F.call,P=S&&F.bind.bind(I,I),R={},x=(B=S?P:function(e){return function(){return I.apply(e,arguments)}})({}.toString),G=B("".slice);R=function(e){return G(x(e),8,-1)};var A=Object,D=B("".split);j=E(function(){return!A("z").propertyIsEnumerable(0)})?function(e){return"String"===R(e)?D(e,""):A(e)}:A;var z={},_={};_=function(e){return null==e};var K=TypeError;z=function(e){if(_(e))throw new K("Can't call method on "+e);return e},L=function(e){return j(z(e))};var N={},V={},W={},Y={},q="object"==typeof document&&document.all;Y=void 0===q&&void 0!==q?function(e){return"function"==typeof e||e===q}:function(e){return"function"==typeof e},W=function(e){return"object"==typeof e?null!==e:Y(e)};var X={},H={};H=function(e,t){var n;return arguments.length<2?(n=g[e],Y(n)?n:void 0):g[e]&&g[e][t]};var U={};U=B({}.isPrototypeOf);var $={},J={},Q={},Z={};Z="undefined"!=typeof navigator&&String(navigator.userAgent)||"";var ee=g.process,et=g.Deno,en=ee&&ee.versions||et&&et.version,er=en&&en.v8;er&&(i=(o=er.split("."))[0]>0&&o[0]<4?1:+(o[0]+o[1])),!i&&Z&&(!(o=Z.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=Z.match(/Chrome\/(\d+)/))&&(i=+o[1]),Q=i;var eo=g.String;$=(J=!!Object.getOwnPropertySymbols&&!E(function(){var e=Symbol("symbol detection");return!eo(e)||!(Object(e) instanceof Symbol)||!Symbol.sham&&Q&&Q<41}))&&!Symbol.sham&&"symbol"==typeof Symbol.iterator;var ei=Object;X=$?function(e){return"symbol"==typeof e}:function(e){var t=H("Symbol");return Y(t)&&U(t.prototype,ei(e))};var el={},ea={},ec={},eu=String;ec=function(e){try{return eu(e)}catch(e){return"Object"}};var es=TypeError;ea=function(e){if(Y(e))return e;throw new es(ec(e)+" is not a function")},el=function(e,t){var n=e[t];return _(n)?void 0:ea(n)};var ef={},ed=TypeError;ef=function(e,t){var n,r;if("string"===t&&Y(n=e.toString)&&!W(r=T(n,e))||Y(n=e.valueOf)&&!W(r=T(n,e))||"string"!==t&&Y(n=e.toString)&&!W(r=T(n,e)))return r;throw new ed("Can't convert object to primitive value")};var ep={},em={},ey={};ey=!1;var ev={},eh=Object.defineProperty;ev=function(e,t){try{eh(g,e,{value:t,configurable:!0,writable:!0})}catch(n){g[e]=t}return t};var eg="__core-js_shared__",eb=em=globalThis[eg]||ev(eg,{});(eb.versions||(eb.versions=[])).push({version:"3.37.1",mode:ey?"pure":"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"}),ep=function(e,t){return em[e]||(em[e]=t||{})};var ew={},eE={},eT=Object;eE=function(e){return eT(z(e))};var eS=B({}.hasOwnProperty);ew=Object.hasOwn||function(e,t){return eS(eE(e),t)};var ek={},eC=0,eO=Math.random(),eM=B(1..toString);ek=function(e){return"Symbol("+(void 0===e?"":e)+")_"+eM(++eC+eO,36)};var eL=g.Symbol,ej=ep("wks"),eB=$?eL.for||eL:eL&&eL.withoutSetter||ek,eF=TypeError,eI=(ew(ej,e="toPrimitive")||(ej[e]=J&&ew(eL,e)?eL[e]:eB("Symbol."+e)),ej[e]);V=function(e,t){if(!W(e)||X(e))return e;var n,r=el(e,eI);if(r){if(void 0===t&&(t="default"),n=T(r,e,t),!W(n)||X(n))return n;throw new eF("Can't convert object to primitive value")}return void 0===t&&(t="number"),ef(e,t)},N=function(e){var t=V(e,"string");return X(t)?t:t+""};var eP={},eR={},ex=g.document,eG=W(ex)&&W(ex.createElement);eR=function(e){return eG?ex.createElement(e):{}},eP=!w&&!E(function(){return 7!==Object.defineProperty(eR("div"),"a",{get:function(){return 7}}).a});var eA=Object.getOwnPropertyDescriptor;n=w?eA:function(e,t){if(e=L(e),t=N(t),eP)try{return eA(e,t)}catch(e){}if(ew(e,t))return M(!T(r,e,t),e[t])};var eD={},ez={};ez=w&&E(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype});var e_={},eK=String,eN=TypeError;e_=function(e){if(W(e))return e;throw new eN(eK(e)+" is not an object")};var eV=TypeError,eW=Object.defineProperty,eY=Object.getOwnPropertyDescriptor,eq="enumerable",eX="configurable",eH="writable";l=w?ez?function(e,t,n){if(e_(e),t=N(t),e_(n),"function"==typeof e&&"prototype"===t&&"value"in n&&eH in n&&!n[eH]){var r=eY(e,t);r&&r[eH]&&(e[t]=n.value,n={configurable:eX in n?n[eX]:r[eX],enumerable:eq in n?n[eq]:r[eq],writable:!1})}return eW(e,t,n)}:eW:function(e,t,n){if(e_(e),t=N(t),e_(n),eP)try{return eW(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new eV("Accessors not supported");return"value"in n&&(e[t]=n.value),e},eD=w?function(e,t,n){return l(e,t,M(1,n))}:function(e,t,n){return e[t]=n,e};var eU={},e$={},eJ=Function.prototype,eQ=w&&Object.getOwnPropertyDescriptor,eZ=ew(eJ,"name")&&(!w||w&&eQ(eJ,"name").configurable),e0={},e1=B(Function.toString);Y(em.inspectSource)||(em.inspectSource=function(e){return e1(e)}),e0=em.inspectSource;var e2={},e4={},e7=g.WeakMap;e4=Y(e7)&&/native code/.test(String(e7));var e3={},e8=ep("keys");e3=function(e){return e8[e]||(e8[e]=ek(e))};var e9={};e9={};var e5="Object already initialized",e6=g.TypeError,te=g.WeakMap;if(e4||em.state){var tt=em.state||(em.state=new te);tt.get=tt.get,tt.has=tt.has,tt.set=tt.set,a=function(e,t){if(tt.has(e))throw new e6(e5);return t.facade=e,tt.set(e,t),t},c=function(e){return tt.get(e)||{}},u=function(e){return tt.has(e)}}else{var tn=e3("state");e9[tn]=!0,a=function(e,t){if(ew(e,tn))throw new e6(e5);return t.facade=e,eD(e,tn,t),t},c=function(e){return ew(e,tn)?e[tn]:{}},u=function(e){return ew(e,tn)}}var tr=(e2={set:a,get:c,has:u,enforce:function(e){return u(e)?c(e):a(e,{})},getterFor:function(e){return function(t){var n;if(!W(t)||(n=c(t)).type!==e)throw new e6("Incompatible receiver, "+e+" required");return n}}}).enforce,to=e2.get,ti=String,tl=Object.defineProperty,ta=B("".slice),tc=B("".replace),tu=B([].join),ts=w&&!E(function(){return 8!==tl(function(){},"length",{value:8}).length}),tf=String(String).split("String"),td=e$=function(e,t,n){"Symbol("===ta(ti(t),0,7)&&(t="["+tc(ti(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!ew(e,"name")||eZ&&e.name!==t)&&(w?tl(e,"name",{value:t,configurable:!0}):e.name=t),ts&&n&&ew(n,"arity")&&e.length!==n.arity&&tl(e,"length",{value:n.arity});try{n&&ew(n,"constructor")&&n.constructor?w&&tl(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=tr(e);return ew(r,"source")||(r.source=tu(tf,"string"==typeof t?t:"")),e};Function.prototype.toString=td(function(){return Y(this)&&to(this).source||e0(this)},"toString"),eU=function(e,t,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:t;if(Y(n)&&e$(n,i,r),r.global)o?e[t]=n:ev(t,n);else{try{r.unsafe?e[t]&&(o=!0):delete e[t]}catch(e){}o?e[t]=n:l(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e};var tp={},tm={},ty={},tv={},th={},tg={},tb=Math.ceil,tw=Math.floor;tg=Math.trunc||function(e){var t=+e;return(t>0?tw:tb)(t)},th=function(e){var t=+e;return t!=t||0===t?0:tg(t)};var tE=Math.max,tT=Math.min;tv=function(e,t){var n=th(e);return n<0?tE(n+t,0):tT(n,t)};var tS={},tk={},tC=Math.min;tk=function(e){var t=th(e);return t>0?tC(t,9007199254740991):0},tS=function(e){return tk(e.length)};var tO=function(e){return function(t,n,r){var o,i=L(t),l=tS(i);if(0===l)return!e&&-1;var a=tv(r,l);if(e&&n!=n){for(;l>a;)if((o=i[a++])!=o)return!0}else for(;l>a;a++)if((e||a in i)&&i[a]===n)return e||a||0;return!e&&-1}},tM={includes:tO(!0),indexOf:tO(!1)}.indexOf,tL=B([].push);ty=function(e,t){var n,r=L(e),o=0,i=[];for(n in r)!ew(e9,n)&&ew(r,n)&&tL(i,n);for(;t.length>o;)ew(r,n=t[o++])&&(~tM(i,n)||tL(i,n));return i};var tj=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype");s=Object.getOwnPropertyNames||function(e){return ty(e,tj)},f=Object.getOwnPropertySymbols;var tB=B([].concat);tm=H("Reflect","ownKeys")||function(e){var t=s(e_(e));return f?tB(t,f(e)):t},tp=function(e,t,r){for(var o=tm(t),i=0;i<o.length;i++){var a=o[i];ew(e,a)||r&&ew(r,a)||l(e,a,n(t,a))}};var tF={},tI=/#|\.prototype\./,tP=function(e,t){var n=tx[tR(e)];return n===tA||n!==tG&&(Y(t)?E(t):!!t)},tR=tP.normalize=function(e){return String(e).replace(tI,".").toLowerCase()},tx=tP.data={},tG=tP.NATIVE="N",tA=tP.POLYFILL="P";tF=tP,h=function(e,t){var r,o,i,l,a,c=e.target,u=e.global,s=e.stat;if(r=u?g:s?g[c]||ev(c,{}):g[c]&&g[c].prototype)for(o in t){if(l=t[o],i=e.dontCallGetSet?(a=n(r,o))&&a.value:r[o],!tF(u?o:c+(s?".":"#")+o,e.forced)&&void 0!==i){if(typeof l==typeof i)continue;tp(l,i)}(e.sham||i&&i.sham)&&eD(l,"sham",!0),eU(r,o,l,e)}};var tD={},tz={},t_=Function.prototype,tK=t_.apply,tN=t_.call;tz="object"==typeof Reflect&&Reflect.apply||(S?tN.bind(tK):function(){return tN.apply(tK,arguments)});var tV={},tW={},tY=(tW=function(e){if("Function"===R(e))return B(e)})(tW.bind);tV=function(e,t){return ea(e),void 0===t?e:S?tY(e,t):function(){return e.apply(t,arguments)}};var tq={};tq=H("document","documentElement");var tX={};tX=B([].slice);var tH={},tU=TypeError;tH=function(e,t){if(e<t)throw new tU("Not enough arguments");return e};var t$={};t$=/(?:ipad|iphone|ipod).*applewebkit/i.test(Z);var tJ={};tJ="process"===R(g.process);var tQ=g.setImmediate,tZ=g.clearImmediate,t0=g.process,t1=g.Dispatch,t2=g.Function,t4=g.MessageChannel,t7=g.String,t3=0,t8={},t9="onreadystatechange";E(function(){d=g.location});var t5=function(e){if(ew(t8,e)){var t=t8[e];delete t8[e],t()}},t6=function(e){return function(){t5(e)}},ne=function(e){t5(e.data)},nt=function(e){g.postMessage(t7(e),d.protocol+"//"+d.host)};tQ&&tZ||(tQ=function(e){tH(arguments.length,1);var t=Y(e)?e:t2(e),n=tX(arguments,1);return t8[++t3]=function(){tz(t,void 0,n)},p(t3),t3},tZ=function(e){delete t8[e]},tJ?p=function(e){t0.nextTick(t6(e))}:t1&&t1.now?p=function(e){t1.now(t6(e))}:t4&&!t$?(y=(m=new t4).port2,m.port1.onmessage=ne,p=tV(y.postMessage,y)):g.addEventListener&&Y(g.postMessage)&&!g.importScripts&&d&&"file:"!==d.protocol&&!E(nt)?(p=nt,g.addEventListener("message",ne,!1)):p=t9 in eR("script")?function(e){tq.appendChild(eR("script"))[t9]=function(){tq.removeChild(this),t5(e)}}:function(e){setTimeout(t6(e),0)});var nn=(tD={set:tQ,clear:tZ}).clear;h({global:!0,bind:!0,enumerable:!0,forced:g.clearImmediate!==nn},{clearImmediate:nn});var nr=tD.set,no={},ni={};ni="function"==typeof Bun&&Bun&&"string"==typeof Bun.version;var nl=g.Function,na=/MSIE .\./.test(Z)||ni&&((t=g.Bun.version.split(".")).length<3||"0"===t[0]&&(t[1]<3||"3"===t[1]&&"0"===t[2]));no=function(e,t){var n=t?2:1;return na?function(r,o){var i=tH(arguments.length,1)>n,l=Y(r)?r:nl(r),a=i?tX(arguments,n):[],c=i?function(){tz(l,this,a)}:l;return t?e(c,o):e(c)}:e};var nc=g.setImmediate?no(nr,!1):nr;h({global:!0,bind:!0,enumerable:!0,forced:g.setImmediate!==nc},{setImmediate:nc});const nu=document.querySelector(".game-score"),ns=document.querySelector(".best-score");let nf=0;function nd(e,t="add"){let n=document.getElementById("message-win");"add"===t&&n.classList.add("hidden"),2048===e&&(n.classList.remove("hidden"),nS=!1)}document.addEventListener("DOMContentLoaded",()=>{let e=localStorage.getItem("bestScore")||0;ns.textContent=e});class np{constructor(e,t,n){let r=document.createElement("div");r.classList.add("field-cell"),e.append(r),this.x=t,this.y=n}linkTile(e){e.setXY(this.x,this.y),this.linkedTile=e}unlinkTile(){this.linkedTile=null}unlinkTileForMerge(){this.linkedTileForMerge=null}isEmpty(){return!this.linkedTile}linkTileForMerge(e){e.setXY(this.x,this.y),this.linkedTileForMerge=e}hasTileForMerge(){return!!this.linkedTileForMerge}canAccept(e){return this.isEmpty()||!this.hasTileForMerge()&&this.linkedTile.value===e.value}mergeTiles(){this.linkedTile.setValue(this.linkedTile.value+this.linkedTileForMerge.value),function(e){let t=localStorage.getItem("bestScore")||0;nu.textContent=e,ns.textContent=Math.max(e,t),localStorage.setItem("bestScore",ns.textContent)}(nf+=this.linkedTile.value),this.linkedTileForMerge.removeFromDOM(),this.unlinkTileForMerge(),nd(this.linkedTile.value)}}class nm{constructor(e){this.tileElement=document.createElement("div"),this.tileElement.classList.add("field-cell--tile"),this.setValue(Math.random()>.5?2:4),this.tileElement.textContent=this.value,e.append(this.tileElement)}setXY(e,t){this.x=e,this.y=t,this.tileElement.style.setProperty("--game-field-tile-x",e),this.tileElement.style.setProperty("--game-field-tile-y",t)}setValue(e){this.value=e,this.tileElement.textContent=e,this.tileElement.classList.add("field-cell--"+e)}removeFromDOM(){this.tileElement.remove()}waitForTransitionEnd(){return new Promise(e=>{this.tileElement.addEventListener("transitionend",e,{once:!0})})}waitForAnimationEnd(){return new Promise(e=>{this.tileElement.addEventListener("animationend",e,{once:!0})})}}const ny=document.getElementById("game-field"),nv=document.getElementById("btnStart"),nh=document.getElementById("btnShowControl"),ng=document.getElementById("buttonsControl"),nb=document.getElementById("buttonUp"),nw=document.getElementById("buttonDown"),nE=document.getElementById("buttonLeft"),nT=document.getElementById("buttonRight");let nS=!0,nk=!1;const nC=new class{constructor(e){this.cells=[];for(let t=0;t<16;t++)this.cells.push(new np(e,t%4,Math.floor(t/4)));this.cellsGroupedByColumn=this.groupCellsByColumn(),this.cellsGroupedByReversedColumn=this.cellsGroupedByColumn.map(e=>[...e].reverse()),this.cellsGroupedByRow=this.groupCellsByRow(),this.cellsGroupedByReversedRow=this.cellsGroupedByRow.map(e=>[...e].reverse())}getRandomEmptyCell(){let e=this.cells.filter(e=>e.isEmpty()),t=Math.floor(Math.random()*e.length);return e[t]}groupCellsByColumn(){return this.cells.reduce((e,t)=>(e[t.x]=e[t.x]||[],e[t.x][t.y]=t,e),[])}groupCellsByRow(){return this.cells.reduce((e,t)=>(e[t.y]=e[t.y]||[],e[t.y][t.x]=t,e),[])}}(ny);function nO(e){let t=document.getElementById("message-lose");"add"===e&&t.classList.add("hidden"),"remove"===e&&t.classList.remove("hidden")}function nM(){window.addEventListener("keydown",nL,{once:!0})}async function nL(e){if(!nS)return;switch(e.code){case"ArrowUp":case"KeyW":if(!nR()){nM();return}await nj();break;case"ArrowDown":case"KeyS":if(!nx()){nM();return}await nB();break;case"ArrowLeft":case"KeyA":if(!nG()){nM();return}await nF();break;case"ArrowRight":case"KeyD":if(!nA()){nM();return}await nI();break;default:nM();return}let t=new nm(ny);if(nC.getRandomEmptyCell().linkTile(t),!nR()&&!nx()&&!nG()&&!nA()){await t.waitForAnimationEnd(),nO("remove");return}nM()}async function nj(){await nP(nC.cellsGroupedByColumn)}async function nB(){await nP(nC.cellsGroupedByReversedColumn)}async function nF(){await nP(nC.cellsGroupedByRow)}async function nI(){await nP(nC.cellsGroupedByReversedRow)}async function nP(e){let t=[];e.forEach(e=>(function(e,t){for(let n=1;n<e.length;n++){let r;if(e[n].isEmpty())continue;let o=e[n],i=n-1;for(;i>=0&&e[i].canAccept(o.linkedTile);)r=e[i],i--;r&&(t.push(o.linkedTile.waitForTransitionEnd()),r.isEmpty()?r.linkTile(o.linkedTile):r.linkTileForMerge(o.linkedTile),o.unlinkTile())}})(e,t)),await Promise.all(t),nC.cells.forEach(e=>{e.hasTileForMerge()&&e.mergeTiles()})}function nR(){return nD(nC.cellsGroupedByColumn)}function nx(){return nD(nC.cellsGroupedByReversedColumn)}function nG(){return nD(nC.cellsGroupedByRow)}function nA(){return nD(nC.cellsGroupedByReversedRow)}function nD(e){return e.some(e=>e.some((t,n)=>!(0===n||t.isEmpty())&&e[n-1].canAccept(t.linkedTile)))}function nz(){let e=new nm(ny);nC.getRandomEmptyCell().linkTile(e),nR()||nx()||nG()||nA()||e.waitForAnimationEnd().then(()=>nO("remove"))}nv.addEventListener("click",function(){(function(){let e=document.getElementById("message-start");nd(),nO("add"),e.classList.add("hidden"),nv.classList.remove("start"),nv.classList.add("restart"),nv.textContent="Restart",nC.cells.forEach(e=>{e.isEmpty()||(e.linkedTile.removeFromDOM(),e.unlinkTile())}),nf=0,nu.textContent=0,nS=!0,nC.getRandomEmptyCell().linkTile(new nm(ny)),nC.getRandomEmptyCell().linkTile(new nm(ny)),nM()})()}),nh.addEventListener("click",function(){if(!nk){ng.style.display="flex",nh.classList.add("closeControl"),nh.classList.remove("showControl"),nh.innerHTML="Close Control",nk=!0;return}nh.classList.remove("closeControl"),nh.classList.add("showControl"),ng.style.display="none",nh.innerHTML="Show Control",nk=!1}),nb.addEventListener("click",async function(){nR()&&(await nj(),nz())}),nw.addEventListener("click",async function(){nx()&&(await nB(),nz())}),nE.addEventListener("click",async function(){nG()&&(await nF(),nz())}),nT.addEventListener("click",async function(){nA()&&(await nI(),nz())});
//# sourceMappingURL=index.f59d320c.js.map
